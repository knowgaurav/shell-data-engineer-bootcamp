(window.webpackJsonpMsb=window.webpackJsonpMsb||[]).push([[9],{1852:function(e,t,n){n.r(t),n.d(t,"initializeLivePersonaEditorAsync",(function(){return Ae})),n.d(t,"initializeLivePersonaCardAsync",(function(){return Ge})),n.d(t,"freeBootstrapperMemory",(function(){return We})),n.d(t,"fetchLokiConfigAsync",(function(){return Ue}));var r=n(103),o=n.n(r),i=n(114),a=n.n(i),s=n(195),c=n.n(s),u=n(203),l=n.n(u),d=function(e,t,n,r,o,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=o,this.numberOfRetries=i};function f(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function p(e,t,n){return new a.a((function(r,o){e?(f("LokiAuthToken",e,n),r(e)):t((function(e,t){e?(f("LokiAuthToken",e,n),r(e)):o(new d("GetAuthTokenError","Auth token is undefined",t))}),(function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";o(new d("GetAuthTokenError",r,t,n))}))}))}var v=n(1887),h="{0}/api/v1/livepersonacard/configuration?cultureName={1}";var g=n(111),m=n.n(g),C=n(94),y=n(194);n(2285);var w=function(e,t,n,r,o,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=o,this.numberOfRetries=i};function b(e,t){void 0===t&&(t=window);var n="";if(t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);n=r&&t.decodeURIComponent(r[1].replace(/\+/g," "))||""}return n}var P=function(e,t,n,r,o,i,s){return void 0===o&&(o={}),void 0===i&&(i=6e4),new a.a((function(a,c){var u,l=new XMLHttpRequest,d=function(e,t){var n=b("ClientTypeOverride",t)||e.clientType,r=b("MidgardOnlyOverrideCatalog",t),o=b("HostAppConfiguration",t),i=b("MidgardVersion",t);return{clientTypeOverride:n,hostAppConfigurationQSP:o,versionOverride:(r?"":i)||b("LivePersonaCardVersionOverride",t)||e.versionOverride||"",lpeVersionOverride:(r?"":i)||b("LivePersonaEditorVersionOverride",t),lpeBranchOverride:b("LivePersonaEditorBranchOverride",t),midgardBranchOverride:r?"":b("MidgardBranch",t)}}(n,r),f=d.clientTypeOverride,p=d.hostAppConfigurationQSP,v=d.versionOverride,h=d.lpeVersionOverride,g=d.lpeBranchOverride,C=d.midgardBranchOverride;l.open("GET",e,!0),l.setRequestHeader("Authorization","Bearer "+t),l.setRequestHeader("Accept","application/json");var P=null!==(u=o.requestId)&&void 0!==u?u:Object(y.a)();if(l.setRequestHeader("X-RootCorrelationId",P),l.setRequestHeader("X-CorrelationId",P),l.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),l.setRequestHeader("X-ClientFeature",n.clientFeature),l.setRequestHeader("X-ClientArchitectureVersion","v2"),l.setRequestHeader("X-ClientScenario","GetConfiguration"),s&&l.setRequestHeader("X-LPCVersion",s),f&&l.setRequestHeader("X-ClientType",f),n.app&&l.setRequestHeader("X-HostAppApp",n.app),n.platform&&l.setRequestHeader("X-HostAppPlatform",n.platform),n.hostAppRing&&l.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&l.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&l.setRequestHeader("X-HostAppConfiguration",m()(n.hostAppConfiguration)),p){var L={};p.split(";").forEach((function(e){var t=e.split(":"),n=t[0],r=t[1];L[n]=r})),l.setRequestHeader("HostAppConfiguration",m()(L))}r&&r.React&&r.React.version&&r.ReactDOM&&l.setRequestHeader("X-HostAppReactVersion",r.React.version),v&&(l.setRequestHeader("LivePersonaCardVersionOverride",v),l.setRequestHeader("MidgardVersion",v),"localhost"===v&&"localhost"===r.location.hostname&&l.setRequestHeader("X-Origin",r.location.origin)),h&&l.setRequestHeader("X-".concat("LivePersonaEditorVersionOverride"),h),g&&l.setRequestHeader("X-".concat("LivePersonaEditorBranchOverride"),g),C&&(l.setRequestHeader("MidgardBranch",C),l.setRequestHeader("X-".concat("MidgardBranch"),C)),l.addEventListener("load",(function(){if(200===l.status)try{var e=JSON.parse(l.response);e.RootCorrelationId=P,e.LokiVersion=l.getResponseHeader("x-serverversion")||"",a(e)}catch(e){c(new w("GetLokiConfigError","Failed to parse initialization config.",P))}else c(new w("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(l.status),P,!1,l.status))})),l.addEventListener("error",(function(){c(new w("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",P))})),l.addEventListener("timeout",(function(){c(new w("GetLokiConfigError","Loki config request timed out after ".concat(i," ms."),P))})),l.timeout=i,l.send()}))};function L(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}var T=function(){return(T=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function k(e,t,n){var r,o,i,a,s,c,u=L("LivePersonaCardCultureOverride",n),l=(o=t.region,i=t.complianceEnvironment,a=u||t.culture,s=null===(r=t.options)||void 0===r?void 0:r.lokiUrlOverride,c=Object(v.a)(o,i),s?h.replace("{0}",s).replace("{1}",a):h.replace("{0}",c).replace("{1}",a));return P(l,e,T(T({},t),{clientFeature:"LivePersonaCard"}),n)}function I(e,t,n){var r=function(e,t){var n=t||e.culture,r=Object(v.a)(e.region,e.complianceEnvironment);return"{0}/api/v1/livepersonaeditor/configuration?cultureName={1}".replace("{0}",r).replace("{1}",n)}(t,L("LivePersonaEditorCultureOverride",n));return P(r,e,T(T({},t),{clientFeature:"LivePersonaEditor"}),n)}var R=n(883),x=n.n(R),E=n(274),A=n.n(E),O=n(160),S=n(1139),D=n(113),_=n.n(D),z=n(165),G=n.n(z),W=function(e){var t;return(t={})[e]="SCRUBBED",t};function U(e,t,n,r){return(Object(S.a)(r)?r(e):r)?function e(t,n,r){var i,a,s;void 0===r&&(r=W);var c=_()(t).filter((function(e){return!n.includes(e)})),u=Object(C.__assign)({},t);try{for(var l=Object(C.__values)(c),d=l.next();!d.done;d=l.next()){var f=d.value,p=u[f];if("object"===Object(O.a)(p)&&!G()(p)){var v=e(u[f],n,r);u=o()(u,((s={})[f]=v,s))}else u=o()(u,r(f,u[f]))}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return u}(e,t,n):e}var q=n(3022),F=["app","bootstrapperVersion","clientContextType","clientType","complianceEnvironment","culture","ErrorMessage","ErrorType","flights","hostAppRing","hostAppVersion","IsClientOnline","isConsumer","isConsumer","IsExpected","lokiUrl","name","Perf_AuthRequestDuration","Perf_GetAuthTokenDuration","Perf_GetAuthTokenFromStartDuration","Perf_GetLokiConfigDuration","Perf_GetLokiConfigFromStartDuration","Perf_GetLpcBundlesDuration","Perf_GetLpcBundlesFromStartDuration","Perf_GetLpeBundlesDuration","Perf_GetLpeBundlesFromStartDuration","Perf_InitConfigRequestDuration","Perf_LpcBundleRequestDuration","Perf_LpcStringsRequestDuration","Perf_StartLpcDuration","Perf_StartLpcFromStartDuration","platform","region","settings","versionOverride"],H=function(){return(H=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function B(e,t){var n=new A.a,r=e.telemetryCollectorUrlOneDs,o=function(n){var o,i,a,s,c,u,l,d,f,p,v,h,g,C=e.app,y={disableCookiesUsage:!0,instrumentationKey:n,extensions:[],extensionConfig:[],channelConfiguration:{autoFlushEventsLimit:50,ignoreMc1Ms0CookieProcessing:!0,overrideEndpointUrl:r},propertyConfiguration:{serviceName:C,sessionAsGuid:!0,populateBrowserInfo:!0}},w=new q.a;return w.initialize(y,[]),o=e.culture,i=e.region,a=e.clientType,s=e.clientContextType,c=e.complianceEnvironment,u=e.versionOverride,l=e.hostAppRing,d=e.hostAppVersion,f=e.app,p=e.platform,v=e.isConsumer,h=void 0!==v&&v,g=e.clientCorrelationId,t.setContextProperty("culture",o),t.setContextProperty("region",i),t.setContextProperty("clientType",a),t.setContextProperty("clientContextType",s),t.setContextProperty("bootstrapperVersion","1.20230815.7.0"),t.setContextProperty("complianceEnvironment",c),t.setContextProperty("isConsumer",m()(h)),t.setContextProperty("versionOverride",u||""),t.setContextProperty("hostAppRing",l||""),t.setContextProperty("hostAppVersion",d||""),f&&t.setContextProperty("app",f),p&&t.setContextProperty("platform",p),t.setContextProperty("clientCorrelationId",g),w},i=function(e,i){var a=n.get(e);a||(a=o(e));var s=t.createTelemetryEvent(i,(function(){return!r}));a.track(s),a.flush()};return{logEvent:i,logVerboseEvent:function(t,n){e.enableVerboseLogging&&i(t,n)},updateContextWithLokiConfig:function(e,i){var a=i.ClientTelemetryCollectorUrls;(null==a?void 0:a.OneDs)&&(r=a.OneDs),n.get(e)||n.set(e,o(e));var s=i.LokiUrl,c=i.Flights,u=i.Settings,l=i.TenantAadObjectId,d=i.UserAadObjectId,f=i.UserPuid;s&&t.setContextProperty("lokiUrl",s),c&&t.setContextProperty("flights",c.join(",")),f&&t.setContextProperty("userPuid",f),d&&t.setContextProperty("userAadObjectId",d),l&&t.setContextProperty("tenantAadObjectId",l),u&&t.setContextProperty("settings",m()(u))}}}var j,M=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),V=function(){return n.p},X=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function N(e,t){var n=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),r=t&&"/_next/"!==t&&"/"!==t?new URL(t):void 0,o=new URL(e,document.baseURI).origin;if(o===n.origin||r&&o===r.origin||function(e){return X.includes(e)}(o)||M.test(o))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(o,", only from ").concat(n.origin,", ").concat(null==r?void 0:r.origin," and localhost."))}function J(e,t,n){void 0===t&&(t=V()),void 0===n&&(n=!0);var r,o=null,i=function(){if(void 0===j&&(j=null,"undefined"!=typeof self&&self.trustedTypes))try{j=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e,t){return void 0===t&&(t=V()),N(e,t)}})}catch(e){}return j}();try{o=n&&i?i.createScriptURL(e,t):N(e,t)}catch(e){r=e.message}return{error:r,url:o,trustedTypeAvailable:!!i}}var Q=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},K=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function $(e,t,n,r,o){var i=this;void 0===r&&(r=!1),void 0===o&&(o=!1);var a=0;return function e(t,s){return Q(i,void 0,void 0,(function(){var i;return K(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,6]),[4,Y(t,s,r,o,n)];case 1:return c.sent(),[3,6];case 2:return i=c.sent(),a<2?(a++,[4,e(t,s)]):[3,4];case 3:return c.sent(),[3,5];case 4:throw i.numberOfRetries=a,i;case 5:return[3,6];case 6:return[2]}}))}))}(e,t)}function Y(e,t,n,r,o){return new a.a((function(i,a){t||a(new d("StartLivePersonaCardError","targetWindow is undefined in appendScriptToDocumentAsync"));var s=t.document.querySelectorAll("script[".concat("data-is-midgard-bootstrapper-script","]"));if(r&&2===s.length)i();else{var c=J(e,void 0,n);if(c.error)return a(new d("LoadScriptError",c.error));var u=t.document.createElement("script");u.type="text/javascript",u.charset="utf-8",u.setAttribute("data-is-midgard-bootstrapper-script",""),u.crossOrigin="anonymous",u.src=c.url,u.addEventListener("load",(function(){o&&o({name:"LoadScriptSuccess",properties:{isLPCDefined:!!t.LPC,lpcWindowId:t.lpcWindowId}}),i()})),u.addEventListener("error",(function(){o&&o({name:"LoadScriptFailure",properties:{isLPCDefined:!!t.LPC,lpcWindowId:t.lpcWindowId}}),a(new d("LoadScriptError","Unexpected error while loading script on page, lpcWindowId:"+t.lpcWindowId))})),t.document.body.appendChild(u)}}))}var Z=function(){return(Z=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ee=new x.a;function te(e){var t,n=e.targetWindow||window,r=ee.get(n);return r?r.bootstrapperConfig=Z(Z({},r.bootstrapperConfig),e):(r={bootstrapperConfig:Z(Z({},e),{targetWindow:n}),oneDsLogger:B(e,(t={},{setContextProperty:function(e,n){t[e]=n},getContextProperties:function(){return t},createTelemetryEvent:function(e,n){var r=H({},e);r.properties=o()(r.properties,t);var i=U(r,F,(function(e){var t;return(t={})[e]="EUPI_SCRUBBED",t}),n);return{name:i.name,data:H({},i.properties)}}})),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0,abandonInitializationPromise:void 0}).bootstrapperConfig.targetWindow.lpcWindowId=Object(y.a)(),ee.set(n,r),r}var ne=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},re=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},oe=0;function ie(e,t,n){return ne(this,void 0,void 0,(function(){var r,o;return re(this,(function(i){switch(i.label){case 0:return(o=te(t)).lpcConfig?(r=o.lpcConfig,[3,3]):[3,1];case 1:return[4,ae(e,t,n)];case 2:r=i.sent(),o.lpcConfig=r,i.label=3;case 3:return[2,r]}}))}))}function ae(e,t,n){return ne(this,void 0,void 0,(function(){var r,o;return re(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,k(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,p(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return oe<2?(oe++,[4,ae(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=oe,o;case 7:return[3,8];case 8:return[2,r]}}))}))}function se(e,t,n,r,o){var i=e.ResourceUrls||[];if(0===i.length){var s=e.Resources?e.Resources.livepersonacardstrings:"",c=e.Resources?null==e?void 0:e.Resources["livepersonacard_with-react"]:"";"OwaPeopleHub"===e.Workload&&(c=e.Resources?e.Resources["livepersonacard_without-react"]:""),i=[s,c].filter((function(e){return""!==e}))}return a.a.all(i.map((function(e){return $(e,t,n,r,o)}))).then((function(){return i}))}var ce=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ue=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},le=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function de(e,t){var n=this,r=t.targetWindow;return new a.a((function(o,i){setTimeout((function(){return ce(n,void 0,void 0,(function(){var n,a;return ue(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r||i(new d("StartLivePersonaCardError","targetWindow is undefined in startLivePersonaCardAsync")),r.LPC||i(new d("StartLivePersonaCardError","targetWindow.LPC is undefined., lpcWindowId:"+r.lpcWindowId)),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||i(new d("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined, lpcWindowId:"+r.lpcWindowId)),n=function(e,t){var n,r,o,i=t.targetWindow;return{accountId:t.accountId,refreshAuthToken:(a=t.getAuthToken,function(e){a((function(t,n){e(t,"",n,void 0)}),(function(t,n){e("",t,n,void 0)}))}),contextType:t.clientContextType,strings:i.LivePersonaCardStringsLpcMini&&i.LivePersonaCardStringsLpcMini.strings||i.LivePersonaCardStrings&&i.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId&&Object(y.b)(t.clientCorrelationId)?t.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights?le([],e.Flights,!0):[],isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,setConfigurationManagerForTesting:t.setConfigurationManagerForTesting,lokiUrl:(null===(n=t.options)||void 0===n?void 0:n.lokiUrlOverride)||e.LokiUrl||"",lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId||"",userAadObjectId:e.UserAadObjectId||"",userPuid:e.UserPuid||"",ecsConfigIds:e.EcsConfigIds?le([],e.EcsConfigIds,!0):[],ecsETag:e.EcsEtag||"",loggedInUserUpn:e.Upn||"",loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName||"",app:t.app,platform:t.platform,telemetryCollectorUrlAria:(null===(r=e.ClientTelemetryCollectorUrls)||void 0===r?void 0:r.Aria)||t.telemetryCollectorUrlAria,telemetryCollectorUrlOneDs:(null===(o=e.ClientTelemetryCollectorUrls)||void 0===o?void 0:o.OneDs)||t.telemetryCollectorUrlOneDs,versionOverride:t.versionOverride};var a}(e,t),[4,r.LPC.start(n)];case 1:return s.sent(),o(),[3,3];case 2:return a=s.sent(),i(new d("StartLivePersonaCardError",a.name)),[3,3];case 3:return[2]}}))}))}),0)}))}function fe(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-accc9196-f40d-49fd-8968-2e6240e5d84c-7381";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-3831d322-8b62-464b-8147-272e41908150-7184";case"DoD":return"e5ad760145754ffc9704e67c800087f2-27405810-62d9-4796-a308-28b057a92523-6970";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-97d9a12c-35b6-4ec7-9bb9-d00d7b5d28d2-7079";case"AG08":case"AG09":return"";case"GccModerate":case"Prod":default:return"e5ad760145754ffc9704e67c800087f2-994e0432-dd0e-4a24-9a3d-bb9d8a6b83f3-7303"}}function pe(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==Object(O.a)(navigator.onLine)?navigator.onLine:""}}var ve=n(182),he=n.n(ve),ge=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"))}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach((function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=Math.round(t.duration);-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?e.timings.Perf_AuthRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacard_")?e.timings.Perf_LpcBundleRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?e.timings.Perf_LpcStringsRequestDuration=r:-1!==n.indexOf("/api/v1/configuration/")&&(e.timings.Perf_InitConfigRequestDuration=r)}}))}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():he()()},e}(),me=n(1166);function Ce(e){return void 0===e||"string"!=typeof e||""===e||null===e}function ye(e){var t,n="";if(e){var r=[];Ce(e.culture)&&r.push("culture"),Ce(e.clientType)&&r.push("clientType"),Ce(e.clientContextType)&&r.push("clientContextType"),Ce(e.clientCorrelationId)&&r.push("clientCorrelationId"),(void 0===(t=e.getAuthToken)||"function"!=typeof t)&&r.push("getAuthToken"),r.length>0&&(n="Invalid required parameter(s): ".concat(r.join(", "),". Check the values and types you're passing. ")),e.region&&-1===me.e.indexOf(e.region.toLowerCase().trim())&&(n+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(me.e.join(", ")," for pre-production environments. ")),-1===me.d.indexOf(e.complianceEnvironment)&&(n+="Environment is missing or wrong. Allowed values are: ".concat(me.d.join(", "),". We currently don't support other Sovereign Clouds."))}else n="Config must be defined.";if(n)throw new d("ValidateBootstrapperConfigError",n)}var we=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},be=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Pe=0;function Le(e,t,n){return we(this,void 0,void 0,(function(){var r,o;return be(this,(function(i){switch(i.label){case 0:return(o=te(t)).lpeConfig?(r=o.lpeConfig,[3,3]):[3,1];case 1:return[4,Te(e,t,n)];case 2:r=i.sent(),o.lpeConfig=r,i.label=3;case 3:return[2,r]}}))}))}function Te(e,t,n){return we(this,void 0,void 0,(function(){var r,o;return be(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,I(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,p(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return Pe<2?(Pe++,[4,Le(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=Pe,o;case 7:return[3,8];case 8:return[2,r]}}))}))}var ke=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function Ie(e,t){var n,r,o,i=e.Flights?ke([],e.Flights,!0):[],s=(null===(n=e.Resources)||void 0===n?void 0:n.livepersonaeditorstrings)||"",c=(null===(r=e.Resources)||void 0===r?void 0:r["livepersonaeditor_with-react"])||"",u=(null===(o=e.Resources)||void 0===o?void 0:o["livepersonaeditor_without-react"])||"",l=[s,i.indexOf("withreact")>-1?c:u].filter((function(e){return""!==e}));return a.a.all(l.map((function(e){return $(e,t)}))).then((function(){return l}))}var Re=function(){return(Re=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},xe=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ee=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function Ae(e){return xe(this,void 0,void 0,(function(){var t,n,r,o=this;return Ee(this,(function(i){return t=new ge(window),n=te(e),r=function(){return te(e).oneDsLogger},!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise||(n.lpeInitializationPromise=new a.a((function(n,i){return xe(o,void 0,void 0,(function(){var o,a,s,c,u,l;return Ee(this,(function(d){switch(d.label){case 0:o=fe(e),d.label=1;case 1:return d.trys.push([1,5,,6]),ye(e),t.startCustomTiming("Perf_GetAuthTokenDuration"),[4,p(e.authToken,e.getAuthToken,window)];case 2:return a=d.sent(),t.endCustomTiming("Perf_GetAuthTokenDuration"),t.measureFromStart("Perf_GetAuthTokenFromStartDuration"),t.startCustomTiming("Perf_GetLokiConfigDuration"),[4,Le(a,e,window)];case 3:return s=d.sent(),t.endCustomTiming("Perf_GetLokiConfigDuration"),t.measureFromStart("Perf_GetLokiConfigFromStartDuration"),t.startCustomTiming("Perf_GetLpeBundlesDuration"),[4,Ie(s,window)];case 4:return d.sent(),t.endCustomTiming("Perf_GetLpeBundlesDuration"),t.measureFromStart("Perf_GetLpeBundlesFromStartDuration"),r().updateContextWithLokiConfig(o,s),r().logEvent(o,{name:"initializeLivePersonaEditor_success",properties:Re(Re({},t.getAllTimings()),{RootCorrelationId:s.RootCorrelationId,isConsumer:"".concat(e.isConsumer)})}),n(s),[3,6];case 5:return c=d.sent(),u=c,l=t.getAllTimings(),r().logEvent(o,{name:"initializeLivePersonaEditor_failure",properties:Re(Re(Re({},pe(u)),l),{isConsumer:"".concat(e.isConsumer)})}),i("Failed to initialize Live Persona Editor: ".concat(u.name," ").concat(u.message)),[3,6];case 6:return[2]}}))}))})),n.lpeInitializationPromise.catch((function(){setTimeout((function(){n.forceRefreshLpeInitializationPromise=!0}),3e5)}))),[2,n.lpeInitializationPromise]}))}))}var Oe=function(){return(Oe=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Se=function(e,t,n,r){return new(n||(n=a.a))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},De=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof c.a&&(i[l.a]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};try{var _e=window.document.createElement("link"),ze=Boolean("onmscontentzoom"in window.document);_e.rel=ze?"dns-prefetch":"preconnect",_e.href="https://res-1.cdn.office.net/",window.document.head.appendChild(_e)}catch(e){}function Ge(e){return Se(this,void 0,void 0,(function(){var t,n,r,o,i=this;return De(this,(function(s){return!(t=te(e)).forceRefreshInitializationPromise&&t.initializationPromise||(n=function(){return t?t.oneDsLogger:void 0},r=t.bootstrapperConfig.targetWindow,o=new ge(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new a.a((function(a,s){return Se(i,void 0,void 0,(function(){var i,c,u,l,d,f,v,h,g,m;return De(this,(function(C){switch(C.label){case 0:t.abandonInitializationPromise=function(){var t,a={name:"LPCInitializationAbandonmentError",message:"Live persona card initialization was abandoned",isExpected:!0},c=o.getAllTimings();null===(t=n())||void 0===t||t.logEvent(i,{name:"initializeLivePersonaCard_failure",properties:Oe(Oe(Oe({},pe(a)),c),{isConsumer:"".concat(e.isConsumer),lpcWindowId:r.lpcWindowId})}),s("Failed to initialize Live Persona Card: ".concat(a.name," ").concat(a.message))},i=fe(e),C.label=1;case 1:return C.trys.push([1,6,,7]),ye(e),o.startCustomTiming("Perf_GetAuthTokenDuration"),[4,p(e.authToken,e.getAuthToken,r)];case 2:return c=C.sent(),o.endCustomTiming("Perf_GetAuthTokenDuration"),o.measureFromStart("Perf_GetAuthTokenFromStartDuration"),o.startCustomTiming("Perf_GetLokiConfigDuration"),[4,ie(c,e,r)];case 3:return u=C.sent(),o.endCustomTiming("Perf_GetLokiConfigDuration"),o.measureFromStart("Perf_GetLokiConfigFromStartDuration"),o.startCustomTiming("Perf_GetLpcBundlesDuration"),null===(f=n())||void 0===f||f.updateContextWithLokiConfig(i,u),[4,se(u,r,(function(e){var t;null===(t=n())||void 0===t||t.logVerboseEvent(i,e)}),null===(v=e.options)||void 0===v?void 0:v.isTrustedTypesEnabled,null===(h=e.options)||void 0===h?void 0:h.isReuseScriptsEnabled)];case 4:return C.sent(),o.endCustomTiming("Perf_GetLpcBundlesDuration"),o.measureFromStart("Perf_GetLpcBundlesFromStartDuration"),o.startCustomTiming("Perf_StartLpcDuration"),[4,de(u,t.bootstrapperConfig)];case 5:return C.sent(),o.endCustomTiming("Perf_StartLpcDuration"),o.measureFromStart("Perf_StartLpcFromStartDuration"),null===(g=n())||void 0===g||g.logEvent(i,{name:"initializeLivePersonaCard_success",properties:Oe(Oe({},o.getAllTimings()),{RootCorrelationId:u.RootCorrelationId,isConsumer:"".concat(e.isConsumer),lpcWindowId:r.lpcWindowId})}),a(),[3,7];case 6:return l=C.sent(),d=o.getAllTimings(),null===(m=n())||void 0===m||m.logEvent(i,{name:"initializeLivePersonaCard_failure",properties:Oe(Oe(Oe({},pe(l)),d),{isConsumer:"".concat(e.isConsumer),lpcWindowId:r.lpcWindowId})}),s("Failed to initialize Live Persona Card: ".concat(l.name," ").concat(l.message)),[3,7];case 7:return t.abandonInitializationPromise=void 0,[2]}}))}))})),t.initializationPromise.catch((function(){t.forceRefreshInitializationTimeout=window.setTimeout((function(){t&&(t.forceRefreshInitializationPromise=!0)}),3e5)}))),[2,t.initializationPromise]}))}))}function We(e){!function(e){var t,n,r=ee.get(e);if(r){var o=r.bootstrapperConfig.targetWindow,i=null===(t=r.bootstrapperConfig.options)||void 0===t?void 0:t.isReuseScriptsEnabled;if(o&&(o.LPC&&o.LPC.cleanUp&&o.LPC.cleanUp(),!i)){delete o.LPC,delete o.LivePersonaCardHoverTarget,delete o.LivePersonaCardHoverTargetV2,delete o.LivePersonaCardStrings,delete o.LivePersonaCardStringsLpcMini,delete o.MeetingInsightsV2,delete o.MidgardBootstrapper,delete o.PersonaInsightRing,delete o.LPE,delete o.lpcWindowId;try{o.document.querySelectorAll("script[".concat("data-is-midgard-bootstrapper-script","]")).forEach((function(e){return e.remove()}))}catch(e){}}null===(n=r.abandonInitializationPromise)||void 0===n||n.call(r),delete r.bootstrapperConfig.targetWindow,delete r.oneDsLogger,delete r.bootstrapperConfig,delete r.initializationPromise,delete r.abandonInitializationPromise,clearTimeout(r.forceRefreshInitializationTimeout)}ee.delete(e)}(e)}function Ue(e){return Se(this,void 0,void 0,(function(){var t;return De(this,(function(n){switch(n.label){case 0:return t=te(e),[4,p(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,ie(n.sent(),e,t.bootstrapperConfig.targetWindow)]}}))}))}},1887:function(e,t,n){n.d(t,"a",(function(){return i}));var r=n(1420),o=n(914);function i(e,t){var n=function(e){return"df"===e?o.a.Dogfood:"msit"===e?o.a.MSIT:void 0}(e);return n||(n=Object(r.a)(t)),n}}}]);